# 6.1 Objective 
Train and Generate Music using RNN. Specifically, I would like to generate flute music and notes to practice myself. The flute music I enjoy is European folk music like Gaelic (Irish, Scott) , German, Slavic tunes.

Here is a compact, end-to-end lab you can run on macOS with PyTorch MPS to learn, train, and generate folk flute melodies. Focus is on ABC notation, because Irish and broader European folk tunes are widely available in ABC, they are monophonic, and perfect for an RNN.

# 6.1 Outline

## 6.1.1 Pick representation
- ABC text, one tune per file or separated by X: headers.
- Keep only monophonic voices and strip chords and guitar tabs.
  Concert flute range is about C4 to C7, comfortable D4 to G6. Later you can filter or transpose to this range.
## 6.1.2 Collect a small starter corpus
- Export a few hundred ABC tunes of Irish, German, and Slavic folk. Prioritize reels, jigs, polkas, waltzes, obereks, kujawiaks, kolomyjkas.
    
- Keep keys common for folk flute: D, G, A minor, E Dorian. Optionally transpose everything to D or G to simplify learning.
    
- Keep only headers you need: X, T, M, L, K plus the note lines. Remove ornaments like {grace}, ~, rolls at first.
    

3. Clean and segment
    

- Ensure each tune ends with a marker like \n\n or a custom <EOS>.
    
- Normalize barlines, repeats, and whitespace.
    
- Optional: drop tunes with extreme note ranges.
    

4. Modeling choice
    

- Start with a character-level GRU or LSTM. It is simple and works well for ABC text.
    
- Later you can move to byte-pair tokenization or bar-aware tokens.
    

5. Train fast on Apple Silicon
    

- Use device = torch.device("mps" if torch.backends.mps.is_available() else "cpu").
    
- Small model first: 2 GRU layers, hidden size 384, dropout 0.2, sequence length 256, batch 64, Adam 3e-3, train for ~5 to 20 epochs.
    

6. Generate
    

- Seed with a short ABC prompt containing headers M, L, K and a starter bar like |: d2 e f g a :|
    
- Use temperature sampling. Try temperature 0.9 and top-k 20.
    

7. Export to practice
    

- Convert generated ABC to MIDI and MusicXML with music21, then open in MuseScore or print. Keep tempo moderate and within flute range.

Notes

- Start with a small corpus to verify the pipeline. When it learns barlines, repeats, and consistent keys, scale up.
    
- Use K:D, K:G, K:Am, K:Edor headers in your prompts to steer style.